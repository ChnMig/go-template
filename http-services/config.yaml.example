# HTTP Service 配置文件示例
# 使用前请复制此文件为 config.yaml 并修改其中的配置项
#
# 环境变量支持：
# 所有配置项都可以通过环境变量覆盖，格式为：HTTP_SERVICES_<SECTION>_<KEY>
# 例如：
#   export HTTP_SERVICES_SERVER_PORT=9090        # 覆盖 server.port
#   export HTTP_SERVICES_JWT_KEY="my-secret"     # 覆盖 jwt.key
#   export HTTP_SERVICES_LOG_MAX_SIZE=100        # 覆盖 log.max_size
#
# 配置文件查找顺序：
# 1. 当前目录 (./config.yaml)
# 2. 工作目录 (./config.yaml)
# 3. 系统目录 (/etc/http-services/config.yaml)

server:
  port: 8080

  # ACME 自动 TLS 配置（可选）
  # 启用后服务将通过 ACME（例如 Let's Encrypt）自动签发与续期证书
  # 注意：需要将域名解析至本服务所在机器，并确保 80/443 端口可被公网访问
  enable_acme: false             # 是否启用 ACME 自动 TLS（默认关闭）
  acme_domain: ""                # 证书绑定域名，例如: "api.example.com"
  acme_cache_dir: "acme-cert-cache"  # 证书缓存目录，相对路径基于程序所在目录

  # 本地证书文件 TLS 配置（可选）
  # 启用后服务将直接使用本地证书与私钥文件提供 HTTPS 能力，并在证书/私钥文件发生变化时自动热更新
  # 注意：ACME 与本地证书文件 TLS 模式不能同时启用，请二选一
  enable_tls: false              # 是否启用本地证书文件 TLS 模式
  tls_cert_file: ""              # TLS 证书文件路径（支持相对路径）
  tls_key_file: ""               # TLS 私钥文件路径（支持相对路径）

  # 请求限制配置
  max_body_size: "10MB"           # 请求体大小限制，支持 KB/MB/GB
  max_header_bytes: 1048576       # 请求头大小限制（字节），默认 1MB

  # 超时配置
  shutdown_timeout: "10s"         # 优雅关闭超时时间
  read_timeout: "30s"             # 读取超时
  write_timeout: "30s"            # 写入超时
  idle_timeout: "120s"            # 空闲连接超时

  # 全局限流配置（可选）
  enable_rate_limit: false        # 是否启用全局限流
  global_rate_limit: 100          # 全局限流速率（每秒请求数）
  global_rate_burst: 200          # 全局限流突发容量

jwt:
  key: "YOUR_SECRET_KEY_HERE"  # 务必修改此密钥，否则存在安全风险（至少32字符）
  expiration: "12h"  # JWT token 过期时间，格式: 12h, 24h, 30m 等

log:
  max_size: 50      # 单个日志文件最大大小（MB）
  max_backups: 3    # 保留的旧日志文件最大数量
  max_age: 30       # 保留旧日志文件的最大天数
